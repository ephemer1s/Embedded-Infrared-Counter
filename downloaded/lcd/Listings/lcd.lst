C51 COMPILER V9.56.0.0   LCD                                                               09/28/2020 10:03:49 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE LCD
OBJECT MODULE PLACED IN .\Objects\lcd.obj
COMPILER INVOKED BY: D:\keil\C51\BIN\C51.EXE lcd.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\lcd.lst)
                    - TABS(2) OBJECT(.\Objects\lcd.obj)

line level    source

   1          #include "lcd.h"
   2          #include <stdio.h>
   3          #include <string.h>
   4          #include <stdlib.h>
   5          
   6          /*初始化函数*/
   7          void LcdInit()
   8          
   9          {
  10   1            LcdWriteCom(0x38);  //设置16*2显示，5*7点阵，8位数据线
  11   1            LcdWriteCom(0x0c);  //显示开，光标不闪烁，光标不显示
  12   1            LcdWriteCom(0x06);  //写入数据后，地址指针加1，光标加1，且屏幕不移动
  13   1            LcdWriteCom(0x01);  //清屏
  14   1            LcdWriteCom(0x80);  //设置数据指针起点
  15   1      }
  16          
  17          /*延时函数*/
  18          void Delay(uchar LCD_delay)
  19          { 
  20   1        uchar lcd_del;
  21   1        while(LCD_delay--)
  22   1        {
  23   2          lcd_del=100;
  24   2          while(lcd_del--);
  25   2        }
  26   1      }
  27          
  28          /*写命令函数*/
  29          void LcdWriteCom(uchar com)
  30          {
  31   1            LCDE = 0;    //使能清零
  32   1            LCDRS = 0;   //选择发送命令
  33   1            LCDRW = 0;
  34   1            LCD1602_DB = com;   //写入命令
  35   1            Delay(100); 
  36   1            LCDE = 1;   //下降沿，使指令有效
  37   1            Delay(300);
  38   1            LCDE = 0;
  39   1      }
  40          
  41          /*写数据函数*/
  42          void LcdWriteData(uchar dat)
  43          
  44          {
  45   1      
  46   1            LCDE = 0;    //使能清零
  47   1            LCDRS = 1;   //选择发送数据
  48   1            LCDRW = 0;
  49   1            LCD1602_DB = dat;   //写入数据
  50   1            Delay(100);
  51   1            LCDE = 1;   //下降沿，使指令有效
  52   1            Delay(300);
  53   1            LCDE = 0;
  54   1      
C51 COMPILER V9.56.0.0   LCD                                                               09/28/2020 10:03:49 PAGE 2   

  55   1      }
  56          
  57          /*显示函数*/
  58          void LCD_display(char* Lcddisplay)
  59          {
  60   1        int i;
  61   1        uchar* p; 
  62   1        p = Lcddisplay;
  63   1        
  64   1        if(strlen(Lcddisplay)<16)  //显示一行
  65   1        {
  66   2          LcdWriteCom(0x80);  //数据指针起点
  67   2          for(i = 0;i<strlen(Lcddisplay);i++)
  68   2          {
  69   3            LcdWriteData(*(p++));
  70   3          }
  71   2        }
  72   1        else  //显示两行
  73   1        {
  74   2          LcdWriteCom(0x80);
  75   2          for(i = 0;i<16;i++)
  76   2          {
  77   3            LcdWriteData(*(p++));
  78   3          }   
  79   2          LcdWriteCom(0xc0);  //第二行起点
  80   2          for(i = 16;i<strlen(Lcddisplay);i++)
  81   2          {
  82   3            LcdWriteData(*(p++));
  83   3          }
  84   2        }
  85   1      }
  86          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    257    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       8
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
