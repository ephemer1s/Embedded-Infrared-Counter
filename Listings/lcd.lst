C51 COMPILER V9.54   LCD                                                                   09/30/2020 09:58:27 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE LCD
OBJECT MODULE PLACED IN .\Objects\lcd.obj
COMPILER INVOKED BY: D:\Program Files\Keil\Keil C51 v9.54\C51\BIN\C51.EXE lcd.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXT
                    -END PRINT(.\Listings\lcd.lst) TABS(2) OBJECT(.\Objects\lcd.obj)

line level    source

   1          #include "lcd.h"
   2          #include "ir.h"
   3          #include <stdio.h>
   4          #include <string.h>
   5          #include <stdlib.h>
   6          
   7          void Delay(uchar LCD_delay) { 
   8   1        uchar lcd_del;
   9   1        while(LCD_delay--) {
  10   2          lcd_del=100;
  11   2          while(lcd_del--);
  12   2        }
  13   1      }
  14          
  15          
  16          void LcdWriteCom(uchar com) {
  17   1        /* write command */
  18   1            LCDE = 0;    // energy clc
  19   1            LCDRS = 0;   // select send command
  20   1            LCDRW = 0;
  21   1            LCD1602_DB = com;   // write command
  22   1            Delay(100); 
  23   1            LCDE = 1;    // negedge, which make command available
  24   1            Delay(300);
  25   1            LCDE = 0;
  26   1      }
  27          
  28          
  29          void LcdWriteData(uchar dat) {
  30   1        /* write data */ 
  31   1            LCDE = 0;    // energy clc
  32   1            LCDRS = 1;   // select send data
  33   1            LCDRW = 0;
  34   1            LCD1602_DB = dat;   // write data
  35   1            Delay(100);
  36   1            LCDE = 1;   // negedge
  37   1            Delay(300);
  38   1            LCDE = 0;
  39   1      }
  40          
  41          
  42          void LCD_display(char* Lcddisplay)
  43          {
  44   1        int i;
  45   1        uchar* p; 
  46   1        p = Lcddisplay;
  47   1        
  48   1        if(strlen(Lcddisplay)<16) { // display on 1 line
  49   2          LcdWriteCom(0x80); // data pointer head
  50   2          for(i = 0;i<strlen(Lcddisplay);i++) {
  51   3            LcdWriteData(*(p++));
  52   3          }
  53   2        }
  54   1        else { // display on 2 lines
C51 COMPILER V9.54   LCD                                                                   09/30/2020 09:58:27 PAGE 2   

  55   2          LcdWriteCom(0x80);
  56   2          for(i = 0;i<16;i++) {
  57   3            LcdWriteData(*(p++));
  58   3          }   
  59   2          LcdWriteCom(0xc0);  // 2nd line pointer head
  60   2          for(i = 16;i<strlen(Lcddisplay);i++) {
  61   3            LcdWriteData(*(p++));
  62   3          }
  63   2        }
  64   1      }
  65          
  66          void Press(char *time,char *curtime,char *num)
  67          {
  68   1        char *display;
  69   1        char *blank=" ";
  70   1        strcpy(display, time);
  71   1        strcpy(display, blank);
  72   1        strcpy(display, curtime);
  73   1        strcpy(display, blank);
  74   1        strcpy(display, num);
  75   1        LCD_display(display);
  76   1      }
  77          
  78          /*°´¼üÖÐ¶Ïº¯Êý*/
  79          void Key1() interrupt 0
  80          {
  81   1         if(key1 == 0)
  82   1         {
  83   2          LcdWriteCom(0x01);
  84   2         }
  85   1      }
  86          
  87          void Key2() interrupt 0
  88          {
  89   1         if(key2 == 0)
  90   1         {
  91   2          //display1=&cnt0;
  92   2          //LCD_display(display1);
  93   2         }
  94   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    358    ----
   CONSTANT SIZE    =      2    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      23
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
