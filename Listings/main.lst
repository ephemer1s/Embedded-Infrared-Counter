C51 COMPILER V9.56.0.0   MAIN                                                              09/29/2020 20:05:01 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\keil\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main.ls
                    -t) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <stdio.h>
   2          #include "reg52.h"
   3          
   4          #include "lcd.h"
   5          #include "ir.h"
   6          #include "x5045.h"
   7          
   8          void main(){
   9   1      
  10   1        char *blank = " ", *time = "10s", *curtime1 = "5s", *num = "10";
  11   1        char a,b;
  12   1        char *p;
  13   1        char curtime = 0;
  14   1        /* variable implemetation */
  15   1        int tmp0 = 1, tmp1 = 1;
  16   1        char cnt0 = 0, cnt1 = 0;
  17   1        int maxnum = 10;
  18   1        /* pin init */
  19   1        led0 = 1;
  20   1        led1 = 1;
  21   1        led2 = 1;
  22   1        led3 = 1;
  23   1        
  24   1        /*初始化*/
  25   1        WriteSR(0x12);      //设定看门狗超时周期为600ms，不保护
  26   1        delaynms(10);       //延时10ms
  27   1      
  28   1        SWR = 1;
  29   1        
  30   1        LcdInit();
  31   1        TimeInit();
  32   1        Int0Init();
  33   1        UartInit();
*** WARNING C206 IN LINE 33 OF main.c: 'UartInit': missing function-prototype
  34   1        
  35   1        while(1){
  36   2          /* alert trigger */
  37   2          if(cnt0 > maxnum && led2){
  38   3            led2 = 0;
  39   3          }
  40   2          if(cnt1 > maxnum && led3){
  41   3            led3 = 0;
  42   3          }
  43   2          
  44   2          /* detect phase */
  45   2          if(led0 && led1){  // receive 1st sensor
  46   3            if(IsNegedge(ir0,tmp0)){
  47   4              led0 = 0;
  48   4            }
  49   3            else if(IsNegedge(ir1,tmp1)){
  50   4              led1 = 0;
  51   4            }
  52   3          }
  53   2          else if(!led0 && led1){  // receive 2nd
C51 COMPILER V9.56.0.0   MAIN                                                              09/29/2020 20:05:01 PAGE 2   

  54   3            if(IsPosedge(ir1,tmp1)){
  55   4              led0 = 1;
  56   4              cnt0++;
  57   4      
  58   4              WriteSet(0x30,0x10);
  59   4              delaynms(10);
  60   4              a=ReadSet(0x10);
  61   4              send_char_com(a);    //向串口发送数据
  62   4              WatchDog();          //看门狗复位
  63   4            }
  64   3          }
  65   2          else if(led0 && !led1){  // receive 2nd
  66   3            if(IsPosedge(ir0,tmp0)){
  67   4              led1 = 1;
  68   4              cnt1++;
  69   4              
  70   4              WriteSet(0x31,0x10);
  71   4              delaynms(10);
  72   4              b=ReadSet(0x10);
  73   4              send_char_com(b);    //向串口发送数据
  74   4              WatchDog();          //看门狗复位
  75   4            }
  76   3          }
  77   2          tmp0 = ir0;  // save status
  78   2          tmp1 = ir1;
  79   2          
  80   2          /*液晶屏显示*/
  81   2          if (TF0 == 1){      //判断T0是否溢出                 
  82   3          TF0 = 0;           //清零中断标志
  83   3          TH0 = TimeTH0;     //重新赋初值             
  84   3          TL0 = TimeTL0;             
  85   3          curtime++;         //当前时间加一秒
  86   3          if (curtime >= 100)   //判断T0溢出是否达到1000次
  87   3          {
  88   4            p=&cnt0;
  89   4            LCD_display(p);
  90   4            cnt0=0;
  91   4            curtime=0;
  92   4            }
  93   3          }
  94   2          
  95   2          
  96   2          /*按键中断*/
  97   2          
  98   2          
  99   2        }
 100   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    352    ----
   CONSTANT SIZE    =     12    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      24
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
